uploadFile
==========

此仓库用于存放sencha touch上传相关文件

使用步骤
----------
1. 安装cordova相机、文件以及文件上传的三个插件
2. 在util中添加UploadUtils.js文件
3. 引入ETFramework.util.Uuid文件

上传的问题以及解决机制
----------
1. 概述及问题：  
    图片上传，顾名思义，就是要将拍摄或选择的图片，上传到服务器中。  
    但在图片上传中还存在着以下问题：  
    (1)图片传输时间过长  
    (2)图片上传失败后，无法保证所有图片完整上传  
    (3)图片上传和表单上传存在时间上的冲突  

2. 分析：  
    (1)图片的获取路径：拍照和选择相册中的图片。  
    (2)图片上传时，一般和表单一起上传，图片数据大小一般相对表单多出几十甚至上百倍。  
    
3. 解决：  
    (1)提高图片上传速度  
         ①图片大小的控制  
            在获取图片时，可以对图片的大小进行控制，例如：对于图片的质量进行削减，可以有效减小图片的大小。  
         ②提前图片的上传  
            在图片流程的控制中，可以提前图片的上传，将表单的上传置于最后。例如：在选择完图片或拍照完毕时，马上上传图片。  
    
    (2)保证图片的准确度  
        ①建立队列  
            基于图片可以提前上传，队列被分为两种：  
            *上传成功的本地路径队列；  
            *上传失败的本地路径队列；  
        ②队列控制  
            *在上传成功时，服务器会返回一个文件在线上的路径，判断线上的路径对应的本地路径是否存在，如果存在，则将本地路径放入         到成功队列中，并将其他队列中相同的项去除，如果不存在，则立即对线上发起删除文件的请求；  
            *在上传失败时，将本地路径放入到失败队列中，并将其他队列中相同的项去除；  
            *在图片删除时，立即对于上传成功的文件进行删除。  
        ③注意事项  
            如果提前上传图片失败，则在提交表单时再次上传；  
           一定要保证所有队列中子项的惟一性。  

4. 总结  
    通过提前上传，压缩图片大小和队列控制，保证了图片上传的准确性以及快速性。  
      
5. 存在的问题  
    不提交相关表单，直接返回或退出，服务器上传成功的文件不会被删除。
